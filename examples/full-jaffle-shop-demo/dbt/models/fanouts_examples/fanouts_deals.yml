version: 2
models:
  - name: fanouts_deals
    meta:
      required_attributes:
        is_admin_saas_demo: "true"
      primary_key: deal_id
    columns:
      - name: deal_id
        description: "Unique identifier for this deal"
        meta:
          dimension:
            type: string
          metrics:
            unique_deal_count:
              type: count_distinct
              label: "‚úÖ FANOUT SAFE Unique Deal Count"
              description: "‚úÖ CORRECT: Count distinct deals"

            inflated_deal_count:
              type: count
              label: "üö® INFLATED Deal Count"
              description:
                "‚ùå WRONG: Each deal gets multiplied by (users √ó events) in that
                account"

      - name: account_id
        description: "Links to the account table"
        meta:
          dimension:
            type: string

      - name: stage
        description: "Current stage of the deal"
        meta:
          dimension:
            type: string

      - name: amount
        description: "Deal value in dollars"
        meta:
          dimension:
            type: number
          metrics:
            total_deal_value:
              label: "Total Deal Value"
              format: "usd"
              type: sum

            average_deal_value:
              type: average
              format: "usd"

            max_deal_value:
              type: max
              label: "‚úÖ FANOUT SAFE Max Deal Value"
              description: "Maximum deal value in the dataset"
              format: "usd"

            min_deal_value:
              type: max
              label: "‚úÖ FANOUT SAFE Min Deal Value"
              description: "Minimum deal value in the dataset"
              format: "usd"

            median_deal_value:
              type: median
              label: "üö® INFLATED Median Deal Value"
              description: "Median deal value in the dataset"
              format: "usd"

      - name: created_date
        description: "When the deal was created"
        meta:
          dimension:
            type: date
      - name: plan
        description: ""
        meta:
          dimension:
            type: string
      - name: seats
        description: ""
        meta:
          dimension:
            type: number
